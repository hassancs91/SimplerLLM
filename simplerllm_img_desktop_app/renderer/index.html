<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self' http://localhost:*; img-src 'self' http://localhost:* data:">
    <title>SimplerLLM Image Tools</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Bangers&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles/variables.css">
    <link rel="stylesheet" href="styles/memphis.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/gallery.css">

    <style>
        /* App Layout */
        .app {
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* Decorative shapes in background */
        .generate-view::before {
            content: '';
            position: absolute;
            top: 100px;
            right: 450px;
            width: 60px;
            height: 60px;
            background: var(--memphis-pink);
            border: 3px solid var(--memphis-black);
            border-radius: 50%;
            opacity: 0.3;
            z-index: 0;
            pointer-events: none;
        }

        .generate-view::after {
            content: '';
            position: absolute;
            bottom: 150px;
            left: 30px;
            width: 0;
            height: 0;
            border-left: 25px solid transparent;
            border-right: 25px solid transparent;
            border-bottom: 40px solid var(--memphis-yellow);
            opacity: 0.3;
            z-index: 0;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Title Bar -->
        <div class="titlebar">
            <span class="titlebar__title">SimplerLLM Image Tools</span>
            <div class="titlebar__actions">
                <button class="titlebar__action-btn" id="btn-settings" title="API Keys">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                    </svg>
                </button>
            </div>
            <div class="titlebar__controls">
                <button class="titlebar__btn titlebar__btn--minimize" id="btn-minimize" title="Minimize"></button>
                <button class="titlebar__btn titlebar__btn--maximize" id="btn-maximize" title="Maximize"></button>
                <button class="titlebar__btn titlebar__btn--close" id="btn-close" title="Close"></button>
            </div>
        </div>

        <!-- Tools View (Landing Page) -->
        <div class="tools-view" id="tools-view">
            <h1 class="tools-view__title">Image Tools</h1>
            <div class="tools-grid">
                <!-- Generate Tool Card -->
                <div class="tool-card" data-tool="generate">
                    <div class="tool-card__icon">üé®</div>
                    <div class="tool-card__name">Generate</div>
                    <div class="tool-card__description">Create images from text prompts using AI</div>
                </div>

                <!-- Future Tool Cards (placeholder for extensibility) -->
                <div class="tool-card" style="opacity: 0.5; cursor: not-allowed;">
                    <div class="tool-card__icon" style="background: var(--memphis-gray-light);">‚ú®</div>
                    <div class="tool-card__name">Edit</div>
                    <div class="tool-card__description">Coming soon - Edit and modify images with AI</div>
                </div>

                <div class="tool-card" style="opacity: 0.5; cursor: not-allowed;">
                    <div class="tool-card__icon" style="background: var(--memphis-gray-light);">üîç</div>
                    <div class="tool-card__name">Upscale</div>
                    <div class="tool-card__description">Coming soon - Enhance image resolution</div>
                </div>

                <div class="tool-card" style="opacity: 0.5; cursor: not-allowed;">
                    <div class="tool-card__icon" style="background: var(--memphis-gray-light);">üîÑ</div>
                    <div class="tool-card__name">Variations</div>
                    <div class="tool-card__description">Coming soon - Create variations of images</div>
                </div>
            </div>
        </div>

        <!-- Generate View -->
        <div class="generate-view hidden" id="generate-view">
            <div class="main-container">
                <!-- Left: Gallery Grid -->
                <div class="gallery-pane">
                    <div class="gallery-header">
                        <button class="btn btn--ghost btn--sm" data-action="back">‚Üê Back</button>
                        <h2 class="gallery-header__title">Gallery</h2>
                        <span class="gallery-header__count" id="gallery-count">0 images</span>
                    </div>
                    <div class="gallery-grid" id="gallery-grid">
                        <!-- Gallery images will be rendered here -->
                    </div>
                </div>

                <!-- Right: Generation Controls -->
                <div class="control-pane">
                    <!-- Prompt Section -->
                    <div class="control-section">
                        <h3 class="section-title">Prompt</h3>
                        <textarea
                            class="prompt-textarea"
                            id="prompt-input"
                            placeholder="Describe the image you want to create...

Example: A serene Japanese garden with cherry blossoms, a small pond with koi fish, and a traditional wooden bridge, painted in watercolor style"
                            rows="5"
                        ></textarea>
                    </div>

                    <!-- Model Configuration -->
                    <div class="control-section">
                        <h3 class="section-title">Model</h3>
                        <div class="input-group">
                            <select class="select" id="model-select">
                                <option value="gemini-2.5-flash-image-preview">Gemini 2.5 Flash (Image Preview)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Aspect Ratio -->
                    <div class="control-section">
                        <h3 class="section-title">Aspect Ratio</h3>
                        <div class="aspect-ratio-selector" id="aspect-ratio-selector">
                            <button class="aspect-btn active" data-ratio="1:1" title="Square">
                                <span class="aspect-btn__icon aspect-btn__icon--square"></span>
                                <span class="aspect-btn__label">1:1</span>
                            </button>
                            <button class="aspect-btn" data-ratio="16:9" title="Landscape">
                                <span class="aspect-btn__icon aspect-btn__icon--landscape"></span>
                                <span class="aspect-btn__label">16:9</span>
                            </button>
                            <button class="aspect-btn" data-ratio="9:16" title="Portrait">
                                <span class="aspect-btn__icon aspect-btn__icon--portrait"></span>
                                <span class="aspect-btn__label">9:16</span>
                            </button>
                        </div>
                    </div>

                    <!-- Generate Button -->
                    <div class="control-section">
                        <button class="btn btn--primary btn--lg" id="btn-generate" style="width: 100%;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 5v14M5 12h14"></path>
                            </svg>
                            Generate
                        </button>

                        <!-- Generation Status -->
                        <div class="generation-status hidden" id="generation-status">
                            <!-- Status content will be rendered by JS -->
                        </div>
                    </div>

                    <!-- Preview Section -->
                    <div class="control-section preview-section hidden" id="preview-section">
                        <!-- Preview will be rendered by JS -->
                    </div>

                    <!-- API Key Reminder -->
                    <div class="control-section" style="margin-top: auto;">
                        <div style="padding: var(--spacing-md); background: var(--bg-secondary); border-radius: var(--border-radius-md); border: 2px dashed var(--memphis-gray);">
                            <p style="font-size: var(--font-size-sm); color: var(--text-secondary); margin-bottom: var(--spacing-sm);">
                                <strong>Note:</strong> You need a Google AI API key to generate images.
                            </p>
                            <button class="btn btn--ghost btn--sm" onclick="settingsManager.open()">
                                Configure API Key
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lightbox Modal -->
        <div class="lightbox hidden" id="lightbox">
            <button class="lightbox__close">√ó</button>
            <div class="lightbox__image-container">
                <img class="lightbox__image" id="lightbox-image" alt="Full size image">
            </div>
            <div class="lightbox__info">
                <p class="lightbox__prompt" id="lightbox-prompt"></p>
                <span class="lightbox__meta" id="lightbox-meta"></span>
                <div class="lightbox__actions">
                    <button class="btn btn--primary btn--sm" onclick="galleryManager.downloadImage(galleryManager.currentImage?.id)">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Download
                    </button>
                    <button class="btn btn--ghost btn--sm" onclick="galleryManager.deleteImage(galleryManager.currentImage?.id)">
                        Delete
                    </button>
                </div>
            </div>
        </div>

        <!-- Settings Panel (Slide-in) -->
        <div class="settings-panel" id="settings-panel">
            <div class="settings-panel__header">
                <h3>API Keys</h3>
                <button class="btn btn--icon btn--ghost" id="btn-close-settings" style="background: transparent; border-color: white;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="settings-panel__content" id="api-keys-container">
                <!-- API key inputs will be dynamically inserted here -->
            </div>
        </div>

        <!-- Toast container -->
        <div id="toast-container"></div>
    </div>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/gallery.js"></script>
    <script src="js/image-generation.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
